<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="customcardlayout2style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">
    <title>New Card Layout with Flexbox</title>
</head>

<body>
    <div class="container">
        <div class="topnav">
            <a class="active" href="#home">Home</a>
            <a href="#news">News</a>
            <a href="#contact">Contact</a>
            <a href="#about">About</a>
        </div>
        <div class="row">
            <!--first card-->
            <div class="profile-card" id="101" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/Friends at sunset.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>
            <!--second card-->
            <div class="profile-card" id="102" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/Jetski at Ocean.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>
            <!--third card-->
            <div class="profile-card" id="103" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/Houses near Rocks.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>
            <!--fourth card-->
            <div class="profile-card" id="104" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/Back to school.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>
            <!--fifth card-->
            <div class="profile-card" id="105" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/skate group.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>
            <!--sixth card-->
            <div class="profile-card" id="106" onclick="togglepopup(this.id)">
                <div class="profile-content">
                    <div class="profile-image">
                        <img src="images/friends camping.png" alt="first">
                    </div>
                    <div class="desc">
                        <h2>Tejas</h2>
                        <p>Hi There. This is Tejas. This is my first time building this layout</p>
                    </div>
                    <div class="views">
                        <span class="count">views</span>
                    </div>

                </div>
            </div>

            <div class="popup" id="popup1">
                <div class="overlay"></div>
                <div class="content">
                    <div class="close-btn" id="close" onclick="togglepopup(this.id)">&times;</div>
                    <!--<iframe class="vid" src="" frameborder="0"></iframe>-->
                    <div class="wrapper">
                        <video class="vid" src="test-video.mp4"></video>
                        <div class="controls">
                            <div class="statusbar">
                                <div class="progress"></div>
                            </div>
                            <button id="play-pause" style="margin-left: 5px;"><i class="fa fa-play"></i></button>
                            <span id="curtimetext" style="margin-left: 10px;">00:00</span> <span> / </span>
                            <span id="durtimetext">00:00</span>
                            <button id="fullscreenbtn"><i class='fa fa-expand'></i></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>

    <script>
        var name1 = document.getElementsByTagName("H2");
        var desc = document.getElementsByTagName("P");
        var video = document.querySelector(".vid");
        var views = document.getElementsByClassName("count");
        var content = document.querySelector(".content");
        var card = document.getElementsByClassName("profile-card");
        var playbtn = document.getElementById("play-pause");
        var popup = document.querySelector(".popup");
        var progress = document.querySelector('.progress');
        var fullscreenbtn = document.getElementById('fullscreenbtn');
        var wrapper = document.querySelector(".wrapper");
        var controls = document.getElementsByClassName("controls");
        var count = [0, 0, 0, 0, 0, 0];
        var vidData;

        window.addEventListener("keydown", keyPress, false);
        playbtn.addEventListener("click", playpause, false);
        fullscreenbtn.addEventListener("click", fullScreen, false);


        //toggle between full screen and compress screen
        function fullScreen() {
            if (document.fullscreenElement || document.webkitFullscreenElement ||
                document.mozFullScreenElement || document.msFullscreenElement) {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    fullscreenbtn.innerHTML = "<i class='fa fa-expand'></i>";
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                    fullscreenbtn.innerHTML = "<i class='fa fa-expand'></i>";
                } else if (document.mozCancelFullScreen) {
                    document.mozCancelFullScreen();
                    fullscreenbtn.innerHTML = "<i class='fa fa-expand'></i>";
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                    fullscreenbtn.innerHTML = "<i class='fa fa-expand'></i>";
                }
                fullscreenbtn.setAttribute("class", "");
            } else {
                if (document.fullscreenEnabled ||
                    document.webkitFullscreenEnabled || document.mozFullScreenEnabled ||
                    document.msFullscreenEnabled) {
                    if (wrapper.requestFullscreen) {
                        wrapper.requestFullscreen();
                        fullscreenbtn.innerHTML = '<i class="fas fa-compress"></i>';
                    } else if (wrapper.webkitRequestFullscreen) {
                        wrapper.webkitRequestFullscreen();
                        fullscreenbtn.innerHTML = '<i class="fas fa-compress"></i>';
                    } else if (wrapper.mozRequestFullScreen) {
                        wrapper.mozRequestFullScreen();
                        fullscreenbtn.innerHTML = '<i class="fas fa-compress"></i>';
                    } else if (wrapper.msRequestFullscreen) {
                        wrapper.msRequestFullscreen();
                        fullscreenbtn.innerHTML = '<i class="fas fa-compress"></i>';
                    }
                    fullscreenbtn.setAttribute("class", "fullscreen");
                }
            }
        }


        //accessing JSON file through AJAX
        var ourRequest = new XMLHttpRequest();
        ourRequest.open('GET', 'https://tejas-deshpande1989.github.io/git-one/vidinfo3.json');
        ourRequest.onload = function () {
            var ourData = JSON.parse(ourRequest.responseText);
            vidData = ourData;
            renderHTML(ourData);
        };
        ourRequest.send();

        //to get the data from the JSON file and rendering into HTML
        function renderHTML(data) {
            for (var i = 0; i < 6; i++) {
                name1[i].innerHTML = data[i].Name;
                desc[i].innerHTML = data[i].Desc;
            }

        }
        // function to close the modal window on pressing of an escape key
        function keyPress(e) {
            if (e.keyCode == "27") {
                togglepopup();
            }
        }

        //toggle between play and pause button
        function playpause() {
            if (video.paused) {
                video.play();
                playbtn.innerHTML = '<i class="fa fa-pause"></i>';
            }
            else {
                video.pause();
                playbtn.innerHTML = '<i class="fa fa-play"></i>';
            }
        }

        //to show the progress of the video
        video.addEventListener('timeupdate', function () {
            var progressPos = video.currentTime / video.duration;
            progress.style.width = progressPos * 100 + "%";
            if (video.ended) {
                playbtn.innerHTML = '<i class="fa fa-play"></i>';
            }
        })

        //to show the duration of the video from total time
        video.addEventListener('timeupdate', function () {

            var curmins = Math.floor(video.currentTime / 60);//Math.floor is to round up the no
            var cursecs = Math.floor(video.currentTime - curmins * 60);
            var durmins = Math.floor(video.duration / 60); // we can also use Math.ceil or Math.round
            var dursecs = Math.floor(video.duration - durmins * 60);
            //if it is a single digit then prepend 0
            if (cursecs < 10) { cursecs = "0" + cursecs; }
            if (dursecs < 10) { dursecs = "0" + dursecs; }
            if (curmins < 10) { curmins = "0" + curmins; }
            if (durmins < 10) { durmins = "0" + durmins; }
            curtimetext.innerHTML = curmins + ":" + cursecs;
            durtimetext.innerHTML = durmins + ":" + dursecs;

        })


        // function to display specific video on a particular button click
        function togglepopup(clicked_id) {
            if (clicked_id === "close") {
                video.pause();
                playbtn.innerHTML = '<i class="fa fa-play"></i>';
                progress.style.width = "0";
            } else if (clicked_id == vidData[0].Id) {
                //video.src = "test-video.mp4";
                video.src = vidData[0].Src;
                count[0] += 1;
                views[0].innerHTML = count[0] + " views";
            } else if (clicked_id == vidData[1].Id) {
                video.src = vidData[1].Src;
                count[1] += 1;
                views[1].innerHTML = count[1] + " views";

            } else if (clicked_id == vidData[2].Id) {
                video.src = vidData[2].Src;
                count[2] += 1;
                views[2].innerHTML = count[2] + " views";
            } else if (clicked_id == vidData[3].Id) {
                video.src = vidData[3].Src;
                count[3] += 1;
                views[3].innerHTML = count[3] + " views";

            } else if (clicked_id == vidData[4].Id) {
                video.src = vidData[4].Src;
                count[4] += 1;
                views[4].innerHTML = count[4] + " views";
            } else if (clicked_id == vidData[5].Id) {
                video.src = vidData[5].Src;
                count[5] += 1;
                views[5].innerHTML = count[5] + " views";
            }
            document.getElementById("popup1").classList.toggle("active");
        }


    </script>
</body>

</html>
